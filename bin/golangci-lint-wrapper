#!/bin/bash
# Wrapper pour KTN-Linter (intégration VSCode)

LINTER_BIN="/workspace/builds/ktn-linter"

# Si le binaire n'existe pas, le construire
if [ ! -f "$LINTER_BIN" ]; then
    cd /workspace
    go build -buildvcs=false -o "$LINTER_BIN" ./cmd/ktn-linter 2>&1
fi

# Scanner tout le projet (./... inclut déjà testdata)
cd /workspace
"$LINTER_BIN" lint --simple --no-color ./... 2>&1 || true

exit 0
