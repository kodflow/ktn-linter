# R√®gle : Constantes

## üìã Description

Les constantes en Go doivent √™tre **regroup√©es** dans des blocs `const ()`, **document√©es** avec un commentaire de groupe ET un commentaire individuel pour chaque constante, et **typ√©es explicitement**.

## üéØ Objectif

**Pourquoi cette r√®gle existe :**
- **Lisibilit√©** : Un code uniforme facilite la compr√©hension rapide
- **Maintenabilit√©** : Les commentaires expliquent le r√¥le de chaque constante
- **Coh√©sion** : Le regroupement th√©matique organise logiquement le code
- **Clart√© des types** : Les types explicites √©vitent les ambigu√Øt√©s et les erreurs de conversion
- **Documentation automatique** : Les outils de documentation (godoc) utilisent ces commentaires

## ‚úÖ Bonne Pratique (target.go)

```go
// Boolean constants
// Ces constantes repr√©sentent des valeurs bool√©ennes pour la configuration
const (
	// EnableFeatureX active la fonctionnalit√© X
	EnableFeatureX bool = true
	// EnableDebug active le mode debug
	EnableDebug bool = false
	// isProduction indique si l'environnement est en production
	isProduction bool = true
)

// Integer constants (int)
// Ces constantes utilisent le type int
const (
	// MaxConnections d√©finit le nombre maximum de connexions simultan√©es
	MaxConnections int = 1000
	// DefaultPort est le port par d√©faut de l'application
	DefaultPort int = 8080
	// maxRetries d√©finit le nombre maximum de tentatives
	maxRetries int = 3
)
```

### Pourquoi c'est bon :
- ‚úÖ **Regroupement th√©matique** : Les constantes li√©es sont ensemble dans un bloc `const ()`
- ‚úÖ **Commentaire de groupe** : Explique le contexte global du groupe
- ‚úÖ **Commentaire individuel** : Chaque constante (publique ET priv√©e) a son propre commentaire
- ‚úÖ **Type explicite** : `bool`, `int`, etc. sont toujours sp√©cifi√©s
- ‚úÖ **Navigation facile** : Structure claire pour les d√©veloppeurs et les outils

## ‚ùå Mauvaise Pratique (from.go)

```go
// ‚ùå ERREUR 1: Constantes sans regroupement
const EnableFeatureX bool = true
const EnableDebug bool = false
const isProduction bool = true

// ‚ùå ERREUR 2: Pas de commentaire de groupe ET pas de commentaires individuels
const (
	ApplicationName string = "MyApp"
	Version         string = "1.0.0"
	defaultEncoding string = "UTF-8"
)

// ‚ùå ERREUR 3: Type non explicite (inf√©r√©)
const (
	MaxConnections = 1000  // Type manquant !
	DefaultPort = 8080     // Type manquant !
	maxRetries = 3         // Type manquant !
)

// ‚ùå ERREUR 4: Commentaire de groupe mais pas de commentaires individuels
// Ces constantes utilisent des entiers 8 bits
const (
	MinAge          int8 = 18  // Pas de commentaire
	MaxAge          int8 = 120 // Pas de commentaire
	defaultPriority int8 = 5   // Pas de commentaire
)
```

### Pourquoi c'est mauvais :
- ‚ùå **Constantes isol√©es** : Difficile de voir les relations entre constantes
- ‚ùå **Manque de documentation** : Impossible de comprendre le r√¥le sans lire le code
- ‚ùå **Type implicite** : Ambigu√Øt√© sur le type r√©el (int ? int64 ? uint ?)
- ‚ùå **Incoh√©rence** : Diff√©rents styles dans le m√™me fichier
- ‚ùå **Maintenance difficile** : Ajout de nouvelles constantes non guid√©

## üîç D√©tection du Linter

### Codes d'erreur

| Code | Description |
|------|-------------|
| `KTN-CONST-001` | Constante d√©clar√©e sans regroupement `const ()` |
| `KTN-CONST-002` | Groupe de constantes sans commentaire de groupe |
| `KTN-CONST-003` | Constante sans commentaire individuel |
| `KTN-CONST-004` | Constante sans type explicite |

### Messages d'erreur

**KTN-CONST-001** :
```
Constante '{nom}' d√©clar√©e individuellement. Regroupez les constantes dans un bloc const ().
Exemple:
  const (
      {nom} {type} = {valeur}
  )
```

**KTN-CONST-002** :
```
Groupe de constantes √† la ligne {ligne} sans commentaire de groupe.
Ajoutez un commentaire avant le bloc const () pour d√©crire l'ensemble.
Exemple:
  // Description du groupe de constantes
  const (...)
```

**KTN-CONST-003** :
```
Constante '{nom}' sans commentaire individuel.
Chaque constante doit avoir un commentaire explicatif.
Exemple:
  // {nom} d√©crit son r√¥le
  {nom} {type} = {valeur}
```

**KTN-CONST-004** :
```
Constante '{nom}' sans type explicite.
Sp√©cifiez toujours le type : bool, string, int, int8, uint, float64, etc.
Exemple:
  {nom} int = {valeur}
```

### Ce que le linter v√©rifie :

1. **Regroupement** : Toutes les constantes doivent √™tre dans un bloc `const ()`
2. **Commentaire de groupe** : Chaque bloc `const ()` doit avoir un commentaire avant
3. **Commentaire individuel** : Chaque constante (publique OU priv√©e) doit avoir son commentaire
4. **Type explicite** : Chaque constante doit avoir son type sp√©cifi√© (bool, int, string, etc.)

## ü§ñ Prompt IA

Pour qu'une IA comprenne et applique cette r√®gle automatiquement :

```
Tu es un expert Go. V√©rifie que TOUTES les constantes respectent ces 4 r√®gles obligatoires :

R√àGLE 1 - REGROUPEMENT :
- Les constantes doivent √™tre dans un bloc const ()
- Ne jamais d√©clarer : const X = 1
- Toujours d√©clarer : const ( X = 1 )

R√àGLE 2 - COMMENTAIRE DE GROUPE :
- Chaque bloc const () doit avoir un commentaire avant le bloc
- Format : // Description du groupe
- Exemple : // HTTP status codes / Ces constantes repr√©sentent...

R√àGLE 3 - COMMENTAIRE INDIVIDUEL :
- CHAQUE constante (publique ET priv√©e) doit avoir son propre commentaire
- Commentaire sur la ligne juste au-dessus
- Format : // NomConstante description de son r√¥le
- Exemple : // MaxRetries d√©finit le nombre maximum de tentatives

R√àGLE 4 - TYPE EXPLICITE :
- TOUJOURS sp√©cifier le type : bool, string, int, int8, int16, int32, int64, uint, uint8, uint16, uint32, uint64, byte, rune, float32, float64, complex64, complex128
- Ne jamais √©crire : const X = 1
- Toujours √©crire : const X int = 1

D√âTECTION D'ERREURS :
1. Si une constante est d√©clar√©e seule (const X = ...) ‚Üí ERREUR KTN-CONST-001
2. Si un bloc const () n'a pas de commentaire avant ‚Üí ERREUR KTN-CONST-002
3. Si une constante n'a pas de commentaire individuel ‚Üí ERREUR KTN-CONST-003
4. Si une constante n'a pas de type explicite ‚Üí ERREUR KTN-CONST-004

Pour corriger le code :
1. Regroupe les constantes par th√®me dans des blocs const ()
2. Ajoute un commentaire de groupe avant chaque bloc
3. Ajoute un commentaire individuel pour CHAQUE constante
4. Ajoute le type explicite pour CHAQUE constante

EXEMPLE PARFAIT :
// HTTP status codes
// Ces constantes repr√©sentent les codes de statut HTTP standards
const (
	// StatusOK indique que la requ√™te a r√©ussi
	StatusOK int = 200
	// StatusCreated indique qu'une ressource a √©t√© cr√©√©e
	StatusCreated int = 201
)
```

## üìö R√©f√©rences

- [Effective Go - Constants](https://go.dev/doc/effective_go#constants)
- [Go Code Review Comments - Constants](https://github.com/golang/go/wiki/CodeReviewComments#declaring-empty-slices)
- [Go Style Guide - Documentation](https://google.github.io/styleguide/go/decisions#documentation)

## üîÑ Sc√©narios de Test

| # | Sc√©nario | Fichier | R√©sultat attendu |
|---|----------|---------|------------------|
| 1 | Constantes sans regroupement | from.go:4-6 | ‚ùå KTN-CONST-001 |
| 2 | Pas de commentaire de groupe ET pas de commentaires individuels | from.go:9-13 | ‚ùå KTN-CONST-002 + KTN-CONST-003 |
| 3 | Type non explicite | from.go:18-24 | ‚ùå KTN-CONST-004 |
| 4 | Commentaire de groupe mais pas de commentaires individuels | from.go:28-32 | ‚ùå KTN-CONST-003 |
| 5 | Pas de regroupement + pas de commentaire | from.go:35-37 | ‚ùå KTN-CONST-001 + KTN-CONST-003 |
| 6 | Type non explicite + pas de commentaire individuel | from.go:41-45 | ‚ùå KTN-CONST-003 + KTN-CONST-004 |
| 7 | Pas de commentaire du tout | from.go:48-52 | ‚ùå KTN-CONST-002 + KTN-CONST-003 |
| 8 | Pas de regroupement + type non explicite | from.go:55-57 | ‚ùå KTN-CONST-001 + KTN-CONST-004 |
| 9 | Commentaire de groupe OK mais types non explicites | from.go:61-68 | ‚ùå KTN-CONST-004 |
| 10 | M√©lange - certaines avec commentaire, d'autres non | from.go:72-77 | ‚ùå KTN-CONST-003 |
| 11 | Pas de regroupement + commentaires mais pas de type | from.go:80-85 | ‚ùå KTN-CONST-001 + KTN-CONST-004 |
| 12 | Une seule constante sans type dans un groupe | from.go:93 | ‚ùå KTN-CONST-004 |
| 13 | Pas de commentaire de groupe | from.go:99-103 | ‚ùå KTN-CONST-002 |
| 14 | Constantes individuelles sans type | from.go:106-108 | ‚ùå KTN-CONST-001 + KTN-CONST-004 |
| 15 | Pas de commentaires individuels | from.go:112-116 | ‚ùå KTN-CONST-003 |
| 16 | Pas de regroupement du tout | from.go:119-121 | ‚ùå KTN-CONST-001 |
| 17 | Groupe sans commentaire de groupe ET types manquants | from.go:124-128 | ‚ùå KTN-CONST-002 + KTN-CONST-004 |
| 18 | Un seul commentaire pour plusieurs constantes | from.go:131-136 | ‚ùå KTN-CONST-003 |
| 19 | Constante orpheline (aucune r√®gle respect√©e) | from.go:139 | ‚ùå KTN-CONST-001 + KTN-CONST-003 + KTN-CONST-004 |
| 20 | M√©lange group√©es/non group√©es m√™me th√®me | from.go:143-152 | ‚ùå KTN-CONST-001 |
| ‚úÖ | Code parfait - Tous les types | target.go | ‚úÖ Aucune erreur |

## üí° Notes

### Exceptions accept√©es

**Aucune exception.** Cette r√®gle s'applique √† :
- ‚úÖ Constantes publiques (export√©es)
- ‚úÖ Constantes priv√©es (non export√©es)
- ‚úÖ Tous les types : bool, string, int, uint, float, complex, byte, rune

### Cas particuliers

**iota** : Les constantes avec iota doivent aussi respecter toutes les r√®gles :
```go
// HTTP methods
// Ces constantes repr√©sentent les m√©thodes HTTP
const (
	// MethodGet repr√©sente la m√©thode GET
	MethodGet int = iota
	// MethodPost repr√©sente la m√©thode POST
	MethodPost
	// MethodPut repr√©sente la m√©thode PUT
	MethodPut
)
```

**Constantes calcul√©es** : M√™me r√®gle avec type explicite :
```go
// Size constants
// Ces constantes d√©finissent des tailles en octets
const (
	// KiB repr√©sente un kibioctet (1024 bytes)
	KiB int = 1 << 10
	// MiB repr√©sente un m√©bioctet (1024 KiB)
	MiB int = 1 << 20
)
```
